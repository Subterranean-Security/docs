<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>The Server - Sandpolis 5.1.2</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "The Server";
    var mkdocs_page_input_path = "server.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Sandpolis 5.1.2</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../getting_started/">Getting Started</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">The Server</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#the-server">The Server</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#geolocation-services">Geolocation Services</a></li>
        
            <li><a class="toctree-l3" href="#permissions">Permissions</a></li>
        
            <li><a class="toctree-l3" href="#authentication-groups">Authentication Groups</a></li>
        
            <li><a class="toctree-l3" href="#generators">Generators</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Sandpolis 5.1.2</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>The Server</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="the-server">The Server</h1>
<h2 id="geolocation-services">Geolocation Services</h2>
<p>Sandpolis is able to get its location information from several sources, but the server can only use one service at a time. To choose a service, set the following system properties:</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>server.geolocation.service</td>
<td><code>ip-api.com</code></td>
<td>The name of the geolocation service to use. Valid values are found in the table below.</td>
</tr>
<tr>
<td>server.geolocation.key</td>
<td><code>null</code></td>
<td>The service API key</td>
</tr>
<tr>
<td>server.geolocation.expiration</td>
<td><code>240</code></td>
<td>The cache timeout in hours</td>
</tr>
</tbody>
</table>
<p>Sandpolis supports the following public geolocation services:</p>
<table>
<thead>
<tr>
<th>Service</th>
<th>Identifier</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://ip-api.com" target="_blank">ip-api.com</a></td>
<td><code>ip-api.com</code></td>
</tr>
<tr>
<td><a href="https://tools.keycdn.com/geo" target="_blank">tools.keycdn.com</a></td>
<td><code>keycdn.com</code></td>
</tr>
</tbody>
</table>
<h2 id="permissions">Permissions</h2>
<p>Since multiple viewers can connect to a particular server at the same time, it's nice to have a permissions system to restrict a user's power. In most cases, a single admin viewer is sufficient for managing Sandpolis. Some advanced use cases require multiple users, which are feasible thanks to the permissions system. </p>
<p>The user permissions system is similar to the MySQL permissions system. Permissions are "granted" to users by the admin upon user creation. These permissions dictate what a user can do on the server. New users have no permissions by default and therefore can do essentially nothing on the server.</p>
<h4 id="permissions-list">Permissions list</h4>
<table>
<thead>
<tr>
<th>Permission</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>server.generate</td>
<td>Rights to use the generator</td>
</tr>
<tr>
<td>server.fs.read</td>
<td>Read access to the server's filesystem</td>
</tr>
<tr>
<td>server.fs.write</td>
<td>Write access to the server's filesystem</td>
</tr>
<tr>
<td>server.users.view</td>
<td>Right to view usernames and permissions of all other users</td>
</tr>
<tr>
<td>server.users.create</td>
<td>Right to create new users (of lesser or equal permissions)</td>
</tr>
<tr>
<td>server.state.stop</td>
<td>Right to stop the server</td>
</tr>
<tr>
<td>server.state.shutdown</td>
<td>Right to shutdown the server</td>
</tr>
<tr>
<td>server.state.restart</td>
<td>Right to restart the server</td>
</tr>
<tr>
<td>server.net.view</td>
<td>Right to open the network control panel</td>
</tr>
<tr>
<td>server.net.create_listener</td>
<td>Right to create a new listener on the server</td>
</tr>
<tr>
<td>server.auth.create_group</td>
<td>Right to create a new authentication group on the server</td>
</tr>
<tr>
<td>client.fs.read</td>
<td>Read access to the client's filesystem</td>
</tr>
<tr>
<td>client.fs.write</td>
<td>Write access to the client's filesystem</td>
</tr>
<tr>
<td>client.state.shutdown</td>
<td>Right to shutdown the client</td>
</tr>
<tr>
<td>client.state.restart</td>
<td>Right to restart the client</td>
</tr>
</tbody>
</table>
<h2 id="authentication-groups">Authentication Groups</h2>
<p>Authentication groups solve two problems:</p>
<ul>
<li>they ensure clients connect to the correct server</li>
<li>they conveniently partition clients so permissions can be easily enforced</li>
</ul>
<p>Since clients are dynamic, enforcing <code>client.*</code> permissions is more complicated than enforcing <code>server.*</code> permissions. This is because the subject of a <code>client.*</code> permission varies with context while a <code>server.*</code> permission always refers to the only server in the network.  </p>
<h2 id="generators">Generators</h2>
<p>Sandpolis is compatible with many different platforms and therefore needs to have a flexible approach to client installation. A <code>Generator</code> is a routine which produces some installation artifact according to a supplied configuration (<code>GenConfig</code>). This installation artifact is then used to install the Sandpolis client on a remote system.</p>
<h3 id="installation-artifacts">Installation Artifacts</h3>
<p>At minimum, installation artifacts contain configuration and settings for the client. Usually, installation artifacts will also contain the actual client code and be runnable on the remote system.</p>
<h4 id="installers">Installers</h4>
<p>An installer contains the full client codebase and is runnable on the remote system. Upon execution, the installer sets up the base directory according to its configuration and executes the client. If the target directory already contains an installation, the old installation is overwritten.  In an automated upgrade scenario, this operation poses no risk to data stored in the old client's database because this data would have been already flushed to the server. A manual upgrade could destroy data cached in the client database and is therefore not recommended.</p>
<h5 id="advantages">Advantages</h5>
<ul>
<li>Simple</li>
<li>Does not require Internet access during installation</li>
</ul>
<h5 id="disadvantages">Disadvantages</h5>
<ul>
<li>File size is large</li>
<li>File transfer may be inconvenient</li>
</ul>
<h5 id="examples">Examples</h5>
<ul>
<li>Runnable Jar files (.jar, .war, .ear)</li>
<li>Windows portable executables (.exe, .msi)</li>
<li>Scripts (.sh, .rb, .py, .bat, ...)</li>
</ul>
<h4 id="downloaders">Downloaders</h4>
<p>Downloaders are similar to installers except dependencies must be downloaded upon execution. This can drastically reduce the size of the resulting installation artifact. Remote dependencies must be located in a Maven repository and not downloaded from the Sandpolis server.</p>
<h5 id="advantages_1">Advantages</h5>
<ul>
<li>Smaller file size</li>
</ul>
<h5 id="disadvantages_1">Disadvantages</h5>
<ul>
<li>Requires Internet access during installation</li>
<li>File transfer may be inconvenient</li>
</ul>
<h5 id="examples_1">Examples</h5>
<ul>
<li>Runnable Jar files (.jar, .war, .ear)</li>
<li>Windows portable executables (.exe, .msi)</li>
<li>Scripts (.sh, .rb, .py, .bat, ...)</li>
</ul>
<h4 id="13-tokens">1.3 Tokens</h4>
<p>A token is an artifact which only contains the client configuration and cannot be executed by itself. When provided to a generic installer, the token allows the client to be installed on the remote system.</p>
<h5 id="advantages_2">Advantages</h5>
<ul>
<li>No files are transferred</li>
</ul>
<h5 id="disadvantages_2">Disadvantages</h5>
<ul>
<li>More user interaction is required</li>
</ul>
<h5 id="examples_2">Examples</h5>
<ul>
<li>Barcodes for use on Android, IOS, etc...</li>
</ul>
<h3 id="generators_1">Generators</h3>
<p>All installation artifacts are first generated on the server using a generator and then transferred to the requesting viewer (or client in the case of an automated upgrade). </p>
<h5 id="generator-queue">Generator Queue</h5>
<p>Since performing a generation is an infrequent task, the server maintains a simple queue of requests (generation configs) and fufills them serially. If the queue becomes full, incoming requests are dropped.</p>
<h5 id="generator-configs">Generator Configs</h5>
<p>A <code>GenConfig</code> specifies what type of generator should process it, any necessary options for that generator, and where to direct the resulting installation artifact. <code>GenConfigs</code> are implicitly created on the viewer from the graphical interface.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../getting_started/" class="btn btn-neutral" title="Getting Started"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../getting_started/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
